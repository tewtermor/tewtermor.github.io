import{_ as o,v as l,x as p,N as h,t as d}from"./entry.9d25ba16.js";const v={name:"pressure-canvas",data(){return{x:0,y:0,canvasLeft:null,canvasTop:null,currentLine:null,pressure:null,brushSize:8,lineWidth:0,isMousedown:!1,points:[],strokeHistory:[]}},computed:{},mounted(){this.canvas=this.$refs.canvas,this.canvasCtx=this.canvas.getContext("2d"),this.resizeEvents(),window.addEventListener("resize",this.resizeEvents)},methods:{preventDefault(t){t.preventDefault()},drawOnCanvas(t){this.canvasCtx.strokeStyle="#572649",this.canvasCtx.lineCap="round",this.canvasCtx.lineJoin="round";const e=t.length-1;if(t.length>=3){const n=(t[e].x+t[e-1].x)/2,s=(t[e].y+t[e-1].y)/2;this.canvasCtx.lineWidth=t[e-1].lineWidth,this.canvasCtx.quadraticCurveTo(t[e-1].x,t[e-1].y,n,s),this.canvasCtx.stroke(),this.canvasCtx.beginPath(),this.canvasCtx.moveTo(n,s)}else{const n=t[e];this.canvasCtx.lineWidth=n.lineWidth,this.canvasCtx.strokeStyle=n.color,this.canvasCtx.beginPath(),this.canvasCtx.moveTo(n.x,n.y),this.canvasCtx.stroke()}},undoDraw(){this.strokeHistory.pop(),this.canvasCtx.clearRect(0,0,this.canvas.width,this.canvas.height),this.strokeHistory.map(function(t){if(this.strokeHistory.length===0)return;this.canvasCtx.beginPath();let e=[];t.map(function(n){e.push(n),this.drawOnCanvas(e)})})},resizeEvents(t){const{clientWidth:e,clientHeight:n,width:s,height:r}=this.canvas;(e!=s||n!=r)&&(this.canvas.width=window.innerWidth*2,this.canvas.height=window.innerHeight*2)},pointerDownHandler(t){if(t.buttons!=1&&t.buttons!=32||t.pointerType!="pen")return;let e=.1,n,s;t.pressure>0&&(e=t.pressure),n=t.pageX*2,s=t.pageY*2,this.isMousedown=!0,this.lineWidth=Math.log(e+1)*40,this.canvasCtx.lineWidth=this.lineWidth,this.points.push({x:n,y:s,lineWidth:this.lineWidth}),this.drawOnCanvas(this.points)},pointerMoveHandler(t){if(t.buttons!=1&&t.buttons!=32||t.pointerType!="pen"||!this.isMousedown)return;t.preventDefault();let e=.1,n,s;t.pressure>0&&(e=t.pressure),n=t.pageX*2,s=t.pageY*2,this.lineWidth=Math.log(e+1)*40*.2+this.lineWidth*.8,this.points.push({x:n,y:s,lineWidth:this.lineWidth}),this.drawOnCanvas(this.points)},pointerUpHandler(t){t.pressure>0&&t.pressure,t.pageX*2,t.pageY*2,this.isMousedown=!1,this.strokeHistory.push([...this.points]),this.points=[],this.lineWidth=0}}};function u(t,e,n,s,r,i){return d(),l("div",null,[p("canvas",{ref:"canvas",class:"p-canvas",onTouchstart:e[0]||(e[0]=h((...a)=>i.preventDefault&&i.preventDefault(...a),["prevent"])),onTouchmove:e[1]||(e[1]=h((...a)=>i.preventDefault&&i.preventDefault(...a),["prevent"])),onPointerup:e[2]||(e[2]=(...a)=>i.pointerUpHandler&&i.pointerUpHandler(...a)),onPointermove:e[3]||(e[3]=(...a)=>i.pointerMoveHandler&&i.pointerMoveHandler(...a)),onPointerdown:e[4]||(e[4]=(...a)=>i.pointerDownHandler&&i.pointerDownHandler(...a))},null,544)])}const x=o(v,[["render",u],["__scopeId","data-v-938a10e7"]]);export{x as default};
